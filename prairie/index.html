---
layout: default
title: prairie
permalink: /prairie/
---

<div class="prairie-root">
	<section class="prairie-progress" aria-labelledby="prairie-heading">
		<h2 id="prairie-heading" class="prairie-sr-only">Progression du trajet Prairie</h2>

		<div class="prairie-track" id="prairie-track" aria-hidden="false">
			<!-- NEW: bullet row above the line -->
			<div id="prairie-bullets" class="prairie-bullets prairie-bullets--hidden" aria-hidden="true">
				<span class="prairie-bullet" data-bullet="0"></span>
				<span class="prairie-bullet" data-bullet="1"></span>
				<span class="prairie-bullet" data-bullet="2"></span>
				<span class="prairie-bullet" data-bullet="3"></span>
				<span class="prairie-bullet" data-bullet="4"></span>
			</div>

			<!-- Ligne pointillée version sci-fi -->
			<div class="prairie-line" aria-hidden="true"></div>

			<!-- Portion déjà parcourue en trait plein -->
			<div class="prairie-line-completed" aria-hidden="true"></div>

			<!-- Extrémités (cliquables) -->
			<div class="prairie-endpoint prairie-endpoint--left" data-entry-id="endpoint-left" role="button"
				tabindex="0" aria-label="Arrivée"></div>

			<div class="prairie-endpoint prairie-endpoint--right" data-entry-id="endpoint-right" role="button"
				tabindex="0" aria-label="Départ"></div>

			<!-- Curseur -->
			<div class="prairie-pointer" id="prairie-pointer" aria-label="Position actuelle sur le trajet"></div>

			<!-- Jalons injectés via JavaScript -->
		</div>

		<div class="prairie-legend">
			<span id="prairie-date-label"></span>
			<span id="prairie-distance-label"></span>
		</div>
	</section>

	<!-- NEW: QR splash panel (shown when no journal is open) -->
	<section id="prairie-qr-splash" class="prairie-qr-splash" aria-label="Scan le QR code">
		<div class="prairie-qr-card">
			<div class="prairie-qr-ink">
				<img id="prairie-qr-splash-img" class="prairie-qr-img" src="qr_default_4815162342.png" alt="QR code">
			</div>
			<div class="prairie-qr-caption">
				<span class="prairie-qr-caption-title">Signal faible</span>
				<span class="prairie-qr-caption-sub">Mauvaise séquence.</span>
			</div>
		</div>
	</section>

	<!-- Journal simple -->
	<section id="prairie-journal" class="prairie-journal prairie-journal--hidden" aria-live="polite">
		<header class="prairie-journal-header">
			<div>
				<h2 id="prairie-journal-title"></h2>
				<p id="prairie-journal-date" class="prairie-journal-date"></p>
			</div>

			<!-- Close button becomes QR button (still closes) -->
			<button type="button" id="prairie-journal-close" class="prairie-journal-close prairie-journal-close--qr"
				aria-label="Fermer">
				<span class="prairie-journal-close-x" aria-hidden="true">×</span>
				<img id="prairie-qr-close-img" class="prairie-qr-img prairie-qr-img--close"
					src="qr_default_4815162342.png" alt="QR code">
			</button>
		</header>

		<div class="prairie-journal-layout">
			<div class="prairie-journal-main">
				<div id="prairie-journal-main-article" class="prairie-journal-main-article"></div>
				<div id="prairie-journal-secondary" class="prairie-journal-secondary"></div>
			</div>
		</div>
	</section>
</div>

<style>
	:root {
		--prairie-progress: 0;
	}

	body {
		margin: 0;
		padding: 0;
		background: #000000;
		color: #dddddd;
	}

	main h1,
	.page-title,
	.prairie-title,
	.markdown-body h1 {
		display: none !important;
	}

	.prairie-root {
		min-height: 100vh;
		display: flex;
		flex-direction: column;
	}

	.prairie-sr-only {
		position: absolute;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		border: 0;
	}

	.prairie-progress {
		width: 100%;
		margin: 6vh auto 4vh;
		position: relative;
	}

	.prairie-track {
		position: relative;
		width: 100%;
		height: 12vh;
		min-height: 90px;
		z-index: 3;
	}

	/* NEW: bullet row */
	.prairie-bullets {
		position: absolute;
		left: 50%;
		top: calc(50% - 28px);
		/* sits above the dotted line */
		transform: translateX(-50%);
		display: flex;
		gap: 10px;
		z-index: 5;
	}

	.prairie-bullets--hidden {
		opacity: 0;
		visibility: hidden;
		transform: translateX(-50%) translateY(-6px);
		transition: opacity 0.2s ease, transform 0.2s ease, visibility 0s linear 0.2s;
	}

	.prairie-bullets--visible {
		opacity: 1;
		visibility: visible;
		transform: translateX(-50%) translateY(0);
		transition: opacity 0.2s ease, transform 0.2s ease;
	}

	.prairie-bullet {
		width: 9px;
		height: 9px;
		border-radius: 999px;
		background: transparent;
		border: 1px solid transparent;
		box-shadow: 0 0 10px rgba(255, 255, 255, 0.06);
	}

	.prairie-bullet--armed {
		border-color: #d8d8d8;
	}

	.prairie-bullet--on {
		background: #d8d8d8;
		border-color: #d8d8d8;
		box-shadow:
			0 0 8px rgba(216, 216, 216, 0.35),
			0 0 14px rgba(216, 216, 216, 0.18);
	}

	.prairie-line {
		position: absolute;
		top: 50%;
		left: 10%;
		width: 80%;
		height: 4px;
		transform: translateY(-50%);
		background-image: radial-gradient(circle, rgba(190, 190, 190, 0.9) 0, rgba(190, 190, 190, 0.9) 45%, transparent 55%);
		background-size: 8px 4px;
		background-repeat: repeat-x;
		opacity: 0.65;
		border-radius: 999px;
		filter: drop-shadow(0 0 6px rgba(200, 200, 200, 0.35));
		z-index: 0;
		pointer-events: none;
	}

	.prairie-line-completed {
		position: absolute;
		top: 50%;
		left: 10%;
		width: 80%;
		height: 8px;
		transform: translateY(-50%);
		pointer-events: none;
		z-index: 1;
	}

	.prairie-line-completed::before {
		content: "";
		position: absolute;
		top: 50%;
		right: 0;
		transform: translateY(-50%);
		height: 4px;
		width: calc(var(--prairie-progress) * 100%);
		background: rgba(200, 200, 200, 0.68);
		border-radius: 999px;
		box-shadow: 0 0 6px rgba(220, 220, 220, 0.6), 0 0 10px rgba(220, 220, 220, 0.4);
	}

	.prairie-endpoint {
		position: absolute;
		top: 50%;
		transform: translate(-50%, -50%);
		border-radius: 50%;
		z-index: 2;
		cursor: pointer;
		pointer-events: auto;
		outline: none;
	}

	.prairie-endpoint--left {
		left: 10%;
		width: 1.5vw;
		height: 1.5vw;
		min-width: 20px;
		min-height: 20px;
		background: #2f8bff;
		box-shadow: 0 0 10px rgba(80, 170, 255, 0.9), 0 0 22px rgba(80, 170, 255, 0.6);
	}

	.prairie-endpoint--right {
		left: 90%;
		width: 1vw;
		height: 1vw;
		min-width: 16px;
		min-height: 16px;
		background: #ff7b45;
		box-shadow: 0 0 10px rgba(255, 136, 76, 0.9), 0 0 22px rgba(255, 136, 76, 0.6);
	}

	.prairie-endpoint--active {
		box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.35), 0 0 18px rgba(255, 255, 255, 0.45);
		transform: translate(-50%, -50%) scale(1.06);
	}

	.prairie-pointer {
		position: absolute;
		top: 50%;
		left: calc(10% + (1 - var(--prairie-progress)) * 80%);
		width: 1.1vw;
		height: 1.1vw;
		min-width: 18px;
		min-height: 18px;
		border-radius: 50%;
		background: #d8d8d8;
		border: 1px solid #f0f0f0;
		transform: translate(-50%, -50%);
		z-index: 3;
		overflow: visible;
		pointer-events: none;
	}

	.prairie-pointer::before,
	.prairie-pointer::after {
		content: "";
		position: absolute;
		inset: 0;
		border-radius: 50%;
		border: 2px solid rgba(220, 220, 220, 0.7);
		opacity: 0;
	}

	.prairie-pointer::before {
		animation: prairiePulseSlow 2.2s ease-out infinite;
	}

	.prairie-pointer::after {
		animation: prairiePulseFast 1.3s ease-out infinite;
		animation-delay: 0.45s;
	}

	@keyframes prairiePulseSlow {
		0% {
			transform: scale(1);
			opacity: 0.95;
		}

		70% {
			transform: scale(3.4);
			opacity: 0;
		}

		100% {
			opacity: 0;
		}
	}

	@keyframes prairiePulseFast {
		0% {
			transform: scale(1);
			opacity: 0.8;
		}

		60% {
			transform: scale(2.6);
			opacity: 0;
		}

		100% {
			opacity: 0;
		}
	}

	.prairie-milestone {
		--prairie-position: 0;
		position: absolute;
		top: 50%;
		left: calc(10% + (1 - var(--prairie-position)) * 80%);
		transform: translate(-50%, -50%);
		width: 0.35vw;
		height: 0.35vw;
		min-width: 12px;
		min-height: 12px;
		border-radius: 50%;
		border: none;
		background: #939393;
		cursor: pointer;
		z-index: 4;
		padding: 0;
		outline: none;
		pointer-events: auto;
	}

	.prairie-milestone::after {
		content: "";
		position: absolute;
		top: 100%;
		left: 50%;
		width: 1px;
		height: 25px;
		margin-top: 4px;
		transform: translateX(-50%);
		background: #6d6d6d;
	}

	.prairie-milestone--active {
		background: #f9ebcf;
	}

	.prairie-legend {
		margin-top: 1rem;
		padding: 0 10%;
		display: flex;
		justify-content: space-between;
		gap: 1rem;
		font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
		font-size: 0.85rem;
		color: #b0b0b0;
		z-index: 3;
		position: relative;
	}

	.prairie-legend span {
		white-space: nowrap;
	}

	/* === QR splash === */

	.prairie-qr-splash {
		width: 80%;
		margin: 4vh 10% 8vh;
		display: block;
	}

	.prairie-qr-card {
		background: rgba(255, 255, 255, 0.03);
		border-radius: 12px;
		box-shadow:
			0 20px 40px rgba(0, 0, 0, 0.75),
			0 0 0 1px rgba(255, 255, 255, 0.05);
		padding: 1.6rem 1.6rem 1.4rem;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 1.4rem;
		flex-wrap: wrap;
	}

	.prairie-qr-ink {
		border-radius: 14px;
		padding: 0.85rem;
		background:
			radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.10), transparent 55%),
			rgba(0, 0, 0, 0.35);
		box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.05);
	}

	.prairie-qr-caption {
		max-width: 420px;
		text-align: left;
		font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
		color: #d8d8d8;
	}

	.prairie-qr-caption-title {
		display: block;
		letter-spacing: 0.16em;
		text-transform: uppercase;
		font-size: 0.78rem;
		color: rgba(216, 216, 216, 0.85);
		margin-bottom: 0.35rem;
	}

	.prairie-qr-caption-sub {
		display: block;
		font-size: 0.95rem;
		line-height: 1.55;
		color: rgba(216, 216, 216, 0.70);
	}

	.prairie-qr-img {
		width: 170px;
		height: 170px;
		display: block;
		image-rendering: pixelated;
		/* “dimmed reversed colour” look */
		filter: invert(1) brightness(0.86) contrast(1.18);
		opacity: 0.86;
		border-radius: 10px;
	}

	/* === Journal === */

	.prairie-journal {
		width: 80%;
		margin: 4vh 10% 8vh;
		max-width: none;
		padding: 2rem 2rem 2.5rem;
		background: #101010;
		border-radius: 10px;
		box-shadow: 0 20px 40px rgba(0, 0, 0, 0.75);
		font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
		color: #f2f2f2;
		position: relative;
	}

	.prairie-journal--hidden {
		display: none;
	}

	.prairie-journal-header {
		display: flex;
		justify-content: space-between;
		align-items: flex-start;
		padding-bottom: 0.75rem;
		margin-bottom: 1.5rem;
		border-bottom: 1px solid rgba(255, 255, 255, 0.08);
		gap: 1rem;
	}

	/* Earth variant (no title/date/separator) */
	.prairie-journal--earth .prairie-journal-header {
		border-bottom: none;
		padding-bottom: 0;
		margin-bottom: 1.3rem;
	}

	.prairie-journal--earth #prairie-journal-title,
	.prairie-journal--earth #prairie-journal-date {
		display: none;
	}

	.prairie-journal-header h2 {
		margin: 0;
		font-size: 1.4rem;
		letter-spacing: 0.08em;
		text-transform: uppercase;
	}

	.prairie-journal-date {
		margin: 0.25rem 0 0;
		font-size: 0.8rem;
		letter-spacing: 0.16em;
		text-transform: uppercase;
		color: #9a9a9a;
	}

	/* Close button QR */
	.prairie-journal-close {
		position: absolute;
		top: 0.7rem;
		right: 0.7rem;
		background: transparent;
		border: none;
		cursor: pointer;
		padding: 0;
	}

	.prairie-journal-close--qr {
		width: 56px;
		height: 56px;
		border-radius: 12px;
		display: grid;
		place-items: center;
		background: rgba(255, 255, 255, 0.03);
		box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.06);
		transition: transform 0.16s ease, box-shadow 0.16s ease, background 0.16s ease;
	}

	.prairie-journal-close--qr:hover,
	.prairie-journal-close--qr:focus-visible {
		transform: translateY(-1px);
		background: rgba(255, 255, 255, 0.06);
		box-shadow:
			0 0 0 1px rgba(255, 255, 255, 0.12),
			0 14px 26px rgba(0, 0, 0, 0.55);
		outline: none;
	}

	.prairie-journal-close-x {
		position: absolute;
		opacity: 0;
		pointer-events: none;
	}

	.prairie-qr-img--close {
		width: 44px;
		height: 44px;
		border-radius: 10px;
	}

	.prairie-journal-layout {
		display: block;
	}

	.prairie-journal-main-article {
		font-size: 0.96rem;
		line-height: 1.7;
		text-align: left;
	}

	.prairie-journal-main-article p {
		margin: 0 0 0.9rem;
	}

	.prairie-journal-secondary {
		margin-top: 1.4rem;
		padding-top: 0.6rem;
		border-top: 1px solid rgba(255, 255, 255, 0.08);
		font-size: 0.9rem;
		line-height: 1.6;
		color: #d0d0d0;
	}

	@media (max-width: 600px) {
		.prairie-progress {
			margin-top: 5vh;
		}

		.prairie-track {
			min-height: 80px;
		}

		.prairie-legend {
			flex-direction: column;
			align-items: flex-start;
		}

		.prairie-qr-img {
			width: 150px;
			height: 150px;
		}

		.prairie-journal-close--qr {
			width: 52px;
			height: 52px;
		}

		.prairie-qr-img--close {
			width: 40px;
			height: 40px;
		}
	}
</style>

<script>
	(function () {
		// --- Config: QR image filenames (keep these next to the page or update paths)
		const QR_DEFAULT_SRC = "qr_default_4815162342.png";
		const QR_FOUND_SRC = "qr_found_bienvenue.png";

		// --- Dates (UTC)
		function utcDate(year, month, day) {
			return new Date(Date.UTC(year, month - 1, day));
		}

		const startDate = utcDate(2025, 9, 1);
		const endDate = utcDate(2026, 6, 1);
		const totalDistanceKm = 349.73e6;

		const USE_MANUAL_DATE = false;
		const MANUAL_DATE = utcDate(2025, 12, 6);

		const dateFormatter = new Intl.DateTimeFormat("fr-FR", { day: "numeric", month: "long", year: "numeric" });
		const numberFormatterMillions = new Intl.NumberFormat("fr-FR", { minimumFractionDigits: 1, maximumFractionDigits: 1 });

		function progressFor(date) {
			const total = endDate.getTime() - startDate.getTime();
			if (total <= 0) return 0;

			let elapsed = date.getTime() - startDate.getTime();
			if (elapsed < 0) elapsed = 0;
			if (elapsed > total) elapsed = total;
			return elapsed / total;
		}

		function updateProgressOnce() {
			const now = USE_MANUAL_DATE ? MANUAL_DATE : new Date();
			const progress = progressFor(now);

			document.documentElement.style.setProperty("--prairie-progress", progress.toString());

			const dateLabel = document.getElementById("prairie-date-label");
			const distanceLabel = document.getElementById("prairie-distance-label");
			if (!dateLabel || !distanceLabel) return;

			dateLabel.textContent = "Aujourd’hui : " + dateFormatter.format(now);

			const traveledKm = totalDistanceKm * progress;
			const traveledMillions = traveledKm / 1e6;
			const totalMillions = totalDistanceKm / 1e6;

			distanceLabel.textContent =
				numberFormatterMillions.format(traveledMillions) + " / " +
				numberFormatterMillions.format(totalMillions) + " millions de km";
		}

		// --- Entries
		const lorem = "<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>";

		// Your existing entries can live here; I’m keeping milestones as requested.
		const milestoneConfig = [
			{ id: "ms-2025-09-26", date: utcDate(2025, 9, 26), label: "26 septembre 2025", title: "Gazette interplanétaire", main: lorem, secondary: "" },
			{ id: "ms-2025-12-01", date: utcDate(2025, 12, 1), label: "1 décembre 2025", title: "Chronique en saison froide", main: lorem, secondary: "" },
			{ id: "ms-2026-02-11", date: utcDate(2026, 2, 11), label: "11 février 2026", title: "Édition de mi-parcours", main: lorem, secondary: "" }
		];

		// Endpoints : dot bleu (Terre) & dot rouge (Mars)
		const endpointEntries = {
			"endpoint-left": {
				title: "Terre",
				label: "",
				main: `
          <div class="prairie-earth-layout">
            <figure class="prairie-earth-figure">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/97/The_Earth_seen_from_Apollo_17.jpg/900px-The_Earth_seen_from_Apollo_17.jpg"
                alt="Image de la Terre vue depuis l'espace">
              <figcaption>
                La Terre vue par Apollo&nbsp;17 (NASA).
              </figcaption>
            </figure>
            <div class="prairie-earth-text">
              <p class="prairie-earth-coords">
                <span>«&nbsp;48.74782451585052, 2.272479816718329&nbsp;»</span>
              </p>
              <p class="prairie-earth-legend"><em>Novitas est terra felicitatis</em></p>
            </div>
          </div>
        `,
				secondary: "",
				editorial: ""
			},
			"endpoint-right": {
				title: "Mars",
				label: "Planète tellurique",
				main: `
          <div class="prairie-mars-layout">
            <figure class="prairie-mars-figure">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/OSIRIS_Mars_true_color.jpg/960px-OSIRIS_Mars_true_color.jpg"
                alt="Image en vraies couleurs de la planète Mars">
              <figcaption>
                Image de Mars en vraies couleurs (ESA / Rosetta / OSIRIS).
              </figcaption>
            </figure>

            <div class="prairie-mars-columns">
              <div>
                <h3>Caractéristiques orbitales</h3>
                <dl class="prairie-deflist">
                  <div class="prairie-deflist-row">
                    <dt>Demi-grand axe</dt>
                    <dd>227&nbsp;944&nbsp;000&nbsp;km (1,52371&nbsp;UA)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Aphélie</dt>
                    <dd>249&nbsp;230&nbsp;000&nbsp;km (1,66602&nbsp;UA)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Périhélie</dt>
                    <dd>206&nbsp;655&nbsp;000&nbsp;km (1,3814&nbsp;UA)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Circonférence orbitale</dt>
                    <dd>1&nbsp;429&nbsp;083&nbsp;000&nbsp;km (9,55283&nbsp;UA)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Excentricité</dt>
                    <dd>0,09339</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Période de révolution</dt>
                    <dd>686,885&nbsp;j (≈&nbsp;1,88&nbsp;an)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Période synodique</dt>
                    <dd>779,804&nbsp;j</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Vitesse orbitale moyenne</dt>
                    <dd>24,080&nbsp;km/s</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Vitesse au périhélie</dt>
                    <dd>26,503&nbsp;km/s</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Vitesse à l’aphélie</dt>
                    <dd>21,975&nbsp;km/s</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Inclinaison sur l’écliptique</dt>
                    <dd>1,85°</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Nœud ascendant</dt>
                    <dd>49,6°</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Argument du périhélie</dt>
                    <dd>286,5°</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Satellites connus</dt>
                    <dd>2 (Phobos, Déimos)</dd>
                  </div>
                </dl>

                <h3>Caractéristiques physiques</h3>
                <dl class="prairie-deflist">
                  <div class="prairie-deflist-row">
                    <dt>Rayon équatorial</dt>
                    <dd>3&nbsp;396,2&nbsp;km (0,533&nbsp;Terre)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Rayon polaire</dt>
                    <dd>3&nbsp;376,2&nbsp;km (0,531&nbsp;Terre)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Rayon moyen</dt>
                    <dd>3&nbsp;389,5&nbsp;km (0,532&nbsp;Terre)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Aplatissement</dt>
                    <dd>0,00589</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Périmètre équatorial</dt>
                    <dd>21&nbsp;344&nbsp;km</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Superficie</dt>
                    <dd>144&nbsp;798&nbsp;500&nbsp;km² (0,284&nbsp;Terre)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Volume</dt>
                    <dd>1,6318&nbsp;×&nbsp;10<sup>11</sup>&nbsp;km³</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Masse</dt>
                    <dd>6,4185&nbsp;×&nbsp;10<sup>23</sup>&nbsp;kg (0,107&nbsp;Terre)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Masse volumique</dt>
                    <dd>3&nbsp;933,5&nbsp;kg/m³</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Gravité de surface</dt>
                    <dd>3,711&nbsp;m/s² (0,379&nbsp;g)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Vitesse de libération</dt>
                    <dd>5,027&nbsp;km/s</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Jour sidéral</dt>
                    <dd>1,025957&nbsp;j (24,622962&nbsp;h)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Rotation à l’équateur</dt>
                    <dd>868,220&nbsp;km/h</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Inclinaison de l’axe</dt>
                    <dd>25,19°</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Albédos (visuel / Bond)</dt>
                    <dd>0,15 / 0,25</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Irradiance solaire</dt>
                    <dd>589,2&nbsp;W/m² (0,431&nbsp;Terre)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>T° équilibre (corps noir)</dt>
                    <dd>210,1&nbsp;K (–62,9&nbsp;°C)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>T° de surface (max / moy / min)</dt>
                    <dd>293&nbsp;K / 210&nbsp;K / 130&nbsp;K</dd>
                  </div>
                </dl>
              </div>

              <div>
                <h3>Atmosphère martienne</h3>
                <dl class="prairie-deflist">
                  <div class="prairie-deflist-row">
                    <dt>Pression au sol</dt>
                    <dd>≈&nbsp;610&nbsp;Pa (30–1&nbsp;155)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Densité au sol</dt>
                    <dd>0,020&nbsp;kg/m³</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Masse totale</dt>
                    <dd>2,5&nbsp;×&nbsp;10<sup>16</sup>&nbsp;kg</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Hauteur d’échelle</dt>
                    <dd>11,1&nbsp;km</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Masse molaire moyenne</dt>
                    <dd>43,34&nbsp;g/mol</dd>
                  </div>
                </dl>

                <h3>Composition principale</h3>
                <dl class="prairie-deflist">
                  <div class="prairie-deflist-row">
                    <dt>CO₂</dt>
                    <dd>96,0&nbsp;%</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Argon (Ar)</dt>
                    <dd>1,93&nbsp;%</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Diazote (N₂)</dt>
                    <dd>1,89&nbsp;%</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>O₂</dt>
                    <dd>0,145&nbsp;%</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>CO</dt>
                    <dd>0,07&nbsp;%</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>H₂O (vapeur)</dt>
                    <dd>0,03&nbsp;%</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>NO</dt>
                    <dd>130&nbsp;ppm</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>H₂</dt>
                    <dd>15&nbsp;ppm</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Ne</dt>
                    <dd>2,5&nbsp;ppm</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>HDO</dt>
                    <dd>850&nbsp;ppb</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Kr</dt>
                    <dd>300&nbsp;ppb</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>CH₂O</dt>
                    <dd>130&nbsp;ppb</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Xe</dt>
                    <dd>80&nbsp;ppb</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>O₃</dt>
                    <dd>30&nbsp;ppb</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>H₂O₂</dt>
                    <dd>18&nbsp;ppb</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>CH₄</dt>
                    <dd>10,5&nbsp;ppb</dd>
                  </div>
                </dl>

                <h3>Références culturelles</h3>
                <dl class="prairie-deflist">
                  <div class="prairie-deflist-row">
                    <dt>Divinité babylonienne</dt>
                    <dd>Nergal</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Divinité grecque</dt>
                    <dd>Ἄρης (Arès)</dd>
                  </div>
                  <div class="prairie-deflist-row">
                    <dt>Nom chinois</dt>
                    <dd>Huǒxīng (火星, «&nbsp;feu&nbsp;»)</dd>
                  </div>
                </dl>
              </div>
            </div>
          </div>
        `,
				secondary: "",
				editorial: ""
			}
		};


		// Hidden entries (hash routes)
		const secretEntries = {
			"4815162342": {
				title: "",
				label: "",
				main: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>`,
				secondary: ""
			},
			"bienvenue": {
				title: "Bienvenue",
				label: "",
				main: `
					<figure style="margin:0; text-align:center;">
						<img src="article_d3_1a.jpg" alt="Bienvenue"
							style="
								display:block;
								max-width: 720px;
								width: 100%;
								margin: 0 auto;
								border-radius: 14px;
								box-shadow: 0 18px 36px rgba(0,0,0,0.65);
							">
					</figure>
				`,
				secondary: ""
			}
		};

		function getEntryById(id) {
			if (endpointEntries[id]) return endpointEntries[id];
			return milestoneConfig.find(m => m.id === id) || null;
		}

		// --- UI helpers
		function setQrSrc(src) {
			const splashImg = document.getElementById("prairie-qr-splash-img");
			const closeImg = document.getElementById("prairie-qr-close-img");
			if (splashImg) splashImg.src = src;
			if (closeImg) closeImg.src = src;
		}

		function showQrSplash() {
			const splash = document.getElementById("prairie-qr-splash");
			if (splash) splash.style.display = "block";
		}

		function hideQrSplash() {
			const splash = document.getElementById("prairie-qr-splash");
			if (splash) splash.style.display = "none";
		}

		function clearActiveStates() {
			document.querySelectorAll(".prairie-milestone").forEach(el => el.classList.remove("prairie-milestone--active"));
			document.querySelectorAll(".prairie-endpoint").forEach(el => el.classList.remove("prairie-endpoint--active"));
		}

		function openJournalWith(data, opts) {
			const journal = document.getElementById("prairie-journal");
			const titleEl = document.getElementById("prairie-journal-title");
			const dateEl = document.getElementById("prairie-journal-date");
			const mainEl = document.getElementById("prairie-journal-main-article");
			const secondaryEl = document.getElementById("prairie-journal-secondary");

			if (!journal || !titleEl || !dateEl || !mainEl || !secondaryEl) return;

			titleEl.textContent = data.title || "";
			dateEl.textContent = data.label || "";
			mainEl.innerHTML = data.main || "";
			secondaryEl.innerHTML = data.secondary || "";

			// Earth variant: no title/date/separator bar
			journal.classList.toggle("prairie-journal--earth", !!(opts && opts.earthMode));

			hideQrSplash();
			journal.classList.remove("prairie-journal--hidden");
		}

		function closeJournal() {
			const journal = document.getElementById("prairie-journal");
			if (journal) {
				journal.classList.add("prairie-journal--hidden");
				journal.classList.remove("prairie-journal--earth");
			}
			clearActiveStates();
			showQrSplash();
		}

		// --- Bullets / hunt logic
		const bulletsEl = document.getElementById("prairie-bullets");
		let clickCount = 0;
		let clickSequence = [];

		const targetOrder = [
			"endpoint-right",
			"ms-2025-09-26",
			"ms-2025-12-01",
			"ms-2026-02-11",
			"endpoint-left"
		];

		function setBulletsVisible(visible) {
			if (!bulletsEl) return;
			bulletsEl.classList.toggle("prairie-bullets--hidden", !visible);
			bulletsEl.classList.toggle("prairie-bullets--visible", visible);
			bulletsEl.setAttribute("aria-hidden", visible ? "false" : "true");
		}

		function resetHunt() {
			clickCount = 0;
			clickSequence = [];
			setBulletsVisible(false);
			if (!bulletsEl) return;
			bulletsEl.querySelectorAll(".prairie-bullet").forEach(b => {
				b.classList.remove("prairie-bullet--armed", "prairie-bullet--on");
			});
		}

		function updateBullets() {
			if (!bulletsEl) return;
			const bullets = bulletsEl.querySelectorAll(".prairie-bullet");

			// After first click: all bullets are “armed” (border on)
			bullets.forEach(b => b.classList.add("prairie-bullet--armed"));

			// Fill up to clickCount
			bullets.forEach((b, idx) => {
				b.classList.toggle("prairie-bullet--on", idx < clickCount);
			});
		}

		function registerClick(entryId) {
			if (clickCount === 0) {
				setBulletsVisible(true);
			}

			clickCount += 1;
			clickSequence.push(entryId);
			updateBullets();

			if (clickCount >= 5) {
				const isCorrect =
					clickSequence.length === targetOrder.length &&
					clickSequence.every((id, i) => id === targetOrder[i]);

				// Reveal via hash
				const nextHash = isCorrect ? "#bienvenue" : "#4815162342";
				window.location.hash = nextHash;

				// Reset immediately (per your spec)
				resetHunt();

				return true; // revealed
			}

			return false;
		}

		// --- Hash handling
		function openFromHash() {
			const raw = (window.location.hash || "").replace(/^#/, "");
			if (!raw) {
				// default page state
				setQrSrc(QR_DEFAULT_SRC);
				return;
			}

			if (secretEntries[raw]) {
				// Use found QR only for #bienvenue
				setQrSrc(raw === "bienvenue" ? QR_FOUND_SRC : QR_DEFAULT_SRC);

				// Show secret entry in journal
				openJournalWith(secretEntries[raw], { earthMode: false });
				clearActiveStates();
				return;
			}
		}

		// --- Click handlers
		function handleEntryClick(entryId) {
			// 3 things happen on click:
			// 1) article pops
			// 2) QR is in close button (already)
			// 3) bullets appear and progress
			const revealed = registerClick(entryId);
			if (revealed) return; // hash will open secret entry

			const data = getEntryById(entryId);
			if (!data) return;

			// QR stays default while browsing entries (you can change if you want)
			setQrSrc(QR_DEFAULT_SRC);

			openJournalWith(data, { earthMode: entryId === "endpoint-left" });

			clearActiveStates();

			// highlight active on bar
			const milestoneEl = document.querySelector(`.prairie-milestone[data-entry-id="${entryId}"]`);
			if (milestoneEl) milestoneEl.classList.add("prairie-milestone--active");

			const endpointEl = document.querySelector(`.prairie-endpoint[data-entry-id="${entryId}"]`);
			if (endpointEl) endpointEl.classList.add("prairie-endpoint--active");
		}

		function attachEndpointHandlers() {
			["endpoint-left", "endpoint-right"].forEach((id) => {
				const el = document.querySelector(`.prairie-endpoint[data-entry-id="${id}"]`);
				if (!el) return;

				el.addEventListener("click", () => handleEntryClick(id));
				el.addEventListener("keydown", (evt) => {
					if (evt.key === "Enter" || evt.key === " ") {
						evt.preventDefault();
						handleEntryClick(id);
					}
				});
			});
		}

		function createMilestones() {
			const track = document.getElementById("prairie-track");
			if (!track) return;

			milestoneConfig.forEach((ms) => {
				const button = document.createElement("button");
				button.type = "button";
				button.className = "prairie-milestone";
				button.setAttribute("aria-label", ms.label);
				button.title = ms.label;
				button.dataset.entryId = ms.id;

				const frac = progressFor(ms.date);
				button.style.setProperty("--prairie-position", frac.toString());

				button.addEventListener("click", () => handleEntryClick(ms.id));
				track.appendChild(button);
			});
		}

		// --- Boot
		document.addEventListener("DOMContentLoaded", function () {
			createMilestones();
			updateProgressOnce();
			attachEndpointHandlers();

			// close button
			const closeBtn = document.getElementById("prairie-journal-close");
			if (closeBtn) closeBtn.addEventListener("click", closeJournal);

			// initial bullets state
			resetHunt();

			// initial QR
			setQrSrc(QR_DEFAULT_SRC);

			// handle hash on load + changes
			openFromHash();
			window.addEventListener("hashchange", openFromHash);
		});
	})();
</script>